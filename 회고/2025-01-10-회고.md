# 2025-01-10 리뷰 및 회고

## 리뷰
### ETL 프로세스 구현하기(M3)
- Raw Data의 양이 매우 커져서 Transform이 원활히 되지 않을 때의 상황을 생각해보았다. 이 과정속에서는 병렬/분산 처리 방식을 도입하여 Transform을 더욱 효율적으로 수행할 수 있다고 생각하였다. 이로 인해 어제 파이썬의 Pool 라이브러리를 이용하여 국가별 USD 단위 변경, Region을 찾아 입력 하는 과정을 멀티프로세싱 방식으로 처리하였다. 기존 print_screen 함수에서 Region별 top5 국가의 GDP를 구하는 고정에서 그루핑 및 정렬하는 과정이 들어가 있었다. 하지만 print_screen 과정은 병렬 처리가 안되어있고, 데이터의 수가 매우 많다면 그루핑 및 정렬을 하는 과정도 시간이 오래걸릴 것이다.
- 위와 같은 문제를 해결해보기 위해 각 Region별 top5 국가의 GDP 평균을 구하는 과정까지 병렬/분산 처리 방식을 도입하였다. 방법은 하둡의 분산/처리 방식인 MapReduce를 파이썬으로 모방해서 구현하고, 이를 Mission3의 transform 과정에 도입해보았다. 
- MapReduce는 분산 컴퓨팅의 대표적인 프레임워크로 대규모 데이터를 분산된 환경에서 병렬로 처리할 수 있도록 도와준다. MapReduce는 Map phase와 Reduce Phase로 구성되어 있으며, 해당 phase 사이에는 Shuffling과 Sorting 단계가 있다. Map Phase를 통해서는 입력 데이터를 작은 조각으로 나눠 key-value 쌍의 형태로 매핑하는 과정이다. Map의 결과는 Shuffling and Sorting 단계로 넘어가, 동일한 키를 갖는 중간 결과들이 같은 태스크에 포함될 수 있도록 분배되며 정렬되게 된다. 이때 결과물은 key, Value List 쌍으로 나오게 된다. 마지막 Reduce 과정에서는 사용자가 정의한 Reduce 함수를 적용하여 목표 결과를 생성하게 되고 이를 합쳐 최종 결과를 생성하게 된다. 
- 위와 같은 과정을 M3의 Region별 top5 국가의 GDP 평균을 구하는 과정에 도입해보았다. Map 과정에서는 국가별 Region을 정해주고, GDP 단위를 변경한 후 key, value 쌍으로 데이터를 추출하였다. 추출된 데이터를 Shuffling 과정을 거쳐 Region을 key로한 value list를 만들었다. 이후 Reduce과정에서 각 Region 별 top5의 GDP 평균을 구하여 최종 결과를 추출하였다. 
- 직접 구현을 통해 MapReduce 방식의 이해를 도울 수 있었고, 병렬/분산 처리에 대한 이해를 조금이나마 높일 수 있었다.
- 한계점으로는 억지로 MapReduce원리를 파이썬 내에서 따라 구현하려고 하다 보니, list, dictionary와 같은 타입의 변환을 계속해서 진행하여 cost가 많이든 점이 아쉬웠다.

### Q. 여러분이 작성한 코드를 ETL로 잘 나눠 보세요. 정의대로 잘 나눠지나요?
여러분이 작성한 코드는 ETL 각각의 단계가 독립적으로 구분되어 작동하나요?
- Extract, Transform,Load 모두 각각의 입력을 받을 수 있고, 출력이 이뤄지도록 구현하여 각 단계가 독립적으로 구분되어 작동되고 있다. 하지만 어디까지가 Extract인지, Transform인지에 대한 경계가 애매모호 하다는 생각이 들기도 하였다. 또 Transform 내에서도 에러 안정성을 위해 분리를 해야 한다고 생각해서 분리했는데, 어느 정도 처리까지 분리를 해야할지 애매한 부분도 있었다.

만약 ETL에서 각각의 과정을 별도로 프로세스로 처리한다면 어떻게 코드를 변경해야 할까요?
- 각각의 input과 output을 받을 수 있는 함수로 구현하여 서로 의존하지 않고, 독립적으로 실행될 수 있도록 함수를 만들어야 한다고 생각한다. 

대용량 데이터를 처리하는 과정에서 에러가 난다면 어떻게 해야 할까요?
- checkpoint를 활용하여 에러가 난 시점 혹은 batch를 로그에 기록하여 두고, 해당 시점 부터 다시 처리를 진행한다. 데이터베이스에서 트랜잭션을 롤백하고, 다시 시도하는 로직처럼 에러가 발생했을 때 복구할 수 있는 시나리오 등을 미리 준비해두어야 할 것 같다. 또 에러가 나지 않기 위해서 적절한 메모리 사용을 유의한 코딩이 필요하다고 생각한다. 

### 기타
- 학습 위키 작성

## 회고
### Keep
- MapReduce와 같은 개념을 따라 파이썬으로 구현해보면서 해당 개념과 원리에 대해 생각해보고 이해할 수 있는 기회가 되어 도움이 되었다고 생각한다.  

### Problem
- 병렬/분산처리 혹은 에러처리와 같은 미션에서 직면한 문제를 찾아내고, 해당 문제를 해결하기 위해 어떤 것을 할 수 있을지 생각해내는 것에 어려움이 있었다. 
- 전체적인 프로그램을 만드는데 예상보다 오래걸린 것 같다. 

### Try
- 문제상황에 대해 생각을 정리해보고, 그에 대한 해결책을 생각해내는 힘을 길러야겠다. 
- prototype처럼 빠르게 만들어보고, 내가 예상한 결과가 맞는지 확인하면서 구체화 할 수 있도록 코딩해봐야겠다.